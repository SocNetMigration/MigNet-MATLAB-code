# Migration_Turkey
This repo contains the dataset and the code that generates the results reported in the paper entitled
"A model of dynamic migration networks: Explaining Turkey's inter-provincial migration flows"

The script "main_migration.m" runs the experiments for three different models.

The Dirichlet-multinomial model with a hierarchical specification, where the migration probabilities have Dirichlet distributions, whose parameters are determined by a regression function. 
The model has a distinct intercept and a time slope parameter for each province; those parameters are themselves random, following the same distributions for all provinces.

Details for those models can be found in the paper.

The main function for inference is the following Matlab function
 [Theta_samp] = Theta_samp, Dec_vec] = MCMC_migration(Y, U, V, Z, M, Theta_init, prop_params, prior_params, year_vec, model_type)

Input data contains the migration counts and the one-way and two-way external factors regarding N provinces for T years.
 
Y is a (T x 1) cell array, each cell contains a matrix of size (N x N) 
Y{t}(i, j): # people migrating from city i to city j.

U is a (T x 1) cell array, each cell matrix of size (K1 x N) 
U(t)(k, i): the value of the i'th feature of the i'th migration-sending province

V is a (T x 1) cell array, each cell matrix of size (K2 x N)
 V(t)(k, j): the value of the k'th feature of the i'th migration-receiving
 province.

 Z is a (T x 1) cell array, each cell contains a matrix of size (N x N x L)
 Z{t}(i, j, l): the value for the l'th feature of cities (i, j)

 M: number of MCMC iterations
 
 theta_init is a cell of initial theta values. Its form is as follows:
  {theta1, theta2, theta3, theta4, theta0, theta0_mu, theta0_Cov}
  where 
 - theta0 is a K0 x N matrix, whose i'th column is the baseline probability parameter of the i'th origin
 Each column of theta0 is assumed to have a normal distribution with mean
 - theta0_mu, a K0 x 1 mean vector, and
 - theta0_Cov, a K0 x K0 covariance matrix. Those two moments are also random.
 
 sigma_prop is a 1 x 5 cell whose members are the 
 - K1 x 1 vector of proposal stds for the random walk MH update for theta1
 - K2 x 1 vector of proposal stds for the random walk MH update for theta2
 - L x 1 vector of proposal stds for the random walk MH update for theta3
 - a scalar proposal std for the random walk MH update for theta4.
 - K0 x 1 vector of proposal stds for the random walk MH update for each vector in theta0.
 
 prior_params is a struct with the following members:
 
 prior_params.prior_var_theta: a cell of 4 elements and the elements are
 the diagonals of the diagonal prior covariance matrices for theta1, 
 theta2, theta3, theta4, respectively.
 
 prior_params.mu0_mean, prior_params.mu0_Cov: mean and covariance of the
 normal distribution assigned to theta0_mu as its prior
 
 prior_params.nu0, prior_params.Psi0: The d.f. and the K0 x K0 scale 
 matrix of inverse-Wishart distribution assigned to theta0_Cov as its
 prior.
 
 year_vec: This is the vector of years that correspond to time steps 1:T

 Output is the a M x D matrix of samples from the MCMC. Each column (sample) is formed as 
 
 [theta1(:); theta2(:); theta3(:); theta4; theta0(:), theta0_mu,  theta0_Cov(:)]
 
All those functions implement a Metropolis-Hastings within Gibbs algorithm that is crafted suitably to the corresponding model.

The data are contained in the files in the directory "Inputfies". The main script automatically imports them suitably.

The outputs are some figures, showing trace plots, histograms, box plots, etc. obtained from the samples generated by the MCMC algorithms. Those figures are saved as eps files in a directory whose name can be specified by the user at the top of the main script "main_migration.m".

The main script "main_migration.m" has also the other parameters that help the user select 
- the models to be investigated,
- the number of iterations, burn-in times,
- factors to be included in the regression functions
- etc.
