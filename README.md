# Code package for the paper <br> A model of dynamic migration networks: Explaining Turkey's inter-provincial migration flows

This repo contains the dataset and the code that generates the results reported in the paper entitled
"*A model of dynamic migration networks: Explaining Turkey's inter-provincial migration flows*"

+ The script **main_migration.m** runs the experiments for real data.
+ The script **main_migration_artificial_data.m** runs the experiments for simulated data.

The real data are contained in the files in the directory "Inputfies". The main script automatically imports them suitably.

The experiment results are shown in figures, showing trace plots, histograms, box plots, etc. obtained from the samples generated by the MCMC algorithms.

The Dirichlet-multinomial model with a hierarchical specification, where the migration probabilities have Dirichlet distributions, whose parameters are determined by a regression function.

The model has a distinct intercept and a time slope parameter for each province; those parameters are themselves random, following the same distributions for all provinces.

Details for those models can be found in the paper.

## Guides for using the code for other data sets
**Algorithm 1** in the paper is an Metropolis-within-Gibbs type MCMC method to estimate the parameters of the Dirichlet-Multinomial model.

The MATLAB code for this algorithm is **MCMC_Migration.m**. To use this code for other data sets, the data must be converted in a certain format. Below are the details of that format.

The Matlab function is the form

*Theta_samp = MCMC_Migration(Y, U, V, Z, year_vec, K0, d0, M)*

Input data contains the migration counts and the one-way and two-way external factors regarding N provinces for T years.
 
- *Y*: a $T \times 1$ cell array, each cell contains a $N \times N$ matrix $Y_{t}$  <br>
$Y_{t}(i, j)$: # people migrating from province $i$ to province $j$.
- *U*: a ($T \times 1$) cell array, each cell contains a $K_{1} \times N$ matrix $U_{t}$ <br> 
$U_{t}(k, i)$: the value of the i'th feature of the i'th migration-sending province
- *V*: a $T \times 1$ cell array, each cell contains a $K_{2} \times N$ matrix $V_{t}$ <br> 
$V_{t}(k, j)$: the value of the k'th feature of the $i$'th migration-receiving province.
- *Z:* a $T \times 1$ cell array, each cell contains a $Z_{t}$ of size $N \times N \times L$ matrix <br> 
$Z_{t}(i, j, l)$: the value for the $l$'th feature of provinces $i, j$ 
+ *year_vec*: This is the vector of years that correspond to time steps $1, \ldots, T$
+ K0: the (order+1) for the polynomial for the baseline probability parameter 
+ d0: number of baseline parameters: $1$ for common baseline and $N$ for a baseline parameter for each province
+ *M*: number of MCMC iterations 

Output is the a $M \times D$ matrix of samples from the MCMC. Each column (sample) is formed as <br>
 $[\theta_{1}, \theta_{2}, \theta_{3}, \theta_{4}, \text{vec}(\theta_{0}), \mu_{0},  \text{vec}(\Sigma_{0})]$
 
